: 
  CALCHEP=  
#-------------------- 

if(test $# -ne 1) then
   echo This routine needs at least one parameter which replace  suffix 
   echo 'ext' in global names and will be  included in the name of generated 
   echo library: proclib_\$1.a 
   echo The second optional parameter describes the destination of the library 
   exit 1
fi

. $CALCHEP/FlagsForSh

cp  $CALCHEP/include/num_in.h $CALCHEP/include/num_out.h $CALCHEP/include/sqme.inc .

for FILE in *.c *.h *.inc
do
   sed  s/_ext/_$1/g $FILE > buff
   mv buff  $FILE
done


if(test -z "$2") then 
   target=`pwd`/proclib_$1.$SO
else 
   target=$2/proclib_$1.$SO
fi

echo $target
   
if(test  "$SONAME") then 
 if(test $CC = gcc) then 
   target="$target -Wl,$SONAME,$target"
 else
   target="$target $SONAME $target"  
 fi 
fi

$CC $SHARED -o $target  $CFLAGS  *.c  
rm -f *.o num_in.h num_out.h sqme.inc
